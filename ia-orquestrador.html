<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>IA Orchestrator - Real</title>
<style>
body{
  margin:0;
  background:#000;
  color:#4fdcff;
  font-family:Arial, Helvetica, sans-serif;
  padding:20px;
}

h2{
  text-align:center;
  text-shadow:0 0 12px #4fdcff;
  margin-bottom:30px;
}

.container{
  display:flex;
  gap:20px;
  flex-wrap:wrap;
  justify-content:center;
}

.box{
  flex:1;
  min-width:350px;
  border:2px solid #4fdcff;
  border-radius:10px;
  padding:20px;
  box-shadow:0 0 20px rgba(79,220,255,.4);
  background:rgba(0,0,0,0.8);
}

h3{
  color:#4fdcff;
  margin-top:0;
  text-align:center;
}

textarea{
  width:100%;
  height:150px;
  background:#111;
  color:#4fdcff;
  border:1px solid #4fdcff;
  padding:12px;
  resize:vertical;
  border-radius:5px;
  font-family:monospace;
  font-size:14px;
}

.output{
  margin-top:15px;
  padding:15px;
  min-height:150px;
  border:1px dashed #4fdcff;
  border-radius:5px;
  white-space:pre-wrap;
  word-break:break-word;
  background:rgba(0,20,30,0.3);
  overflow-y:auto;
  max-height:300px;
}

.buttons{
  margin-top:15px;
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}

button{
  flex:1;
  min-width:120px;
  background:#000;
  color:#4fdcff;
  border:1px solid #4fdcff;
  padding:10px;
  cursor:pointer;
  border-radius:5px;
  transition:all 0.3s;
}

button:hover{
  background:#4fdcff;
  color:#000;
  transform:translateY(-2px);
}

.status{
  margin-top:10px;
  padding:8px;
  border-radius:5px;
  font-size:12px;
  text-align:center;
  display:none;
}

.status.success{
  background:rgba(0,255,0,0.1);
  color:#0f0;
  display:block;
}

.status.error{
  background:rgba(255,0,0,0.1);
  color:#f00;
  display:block;
}

.status.loading{
  background:rgba(79,220,255,0.1);
  color:#4fdcff;
  display:block;
}

.img-container{
  margin:10px 0;
}

.img-container input{
  width:100%;
  padding:8px;
  margin-top:5px;
  background:#111;
  color:#4fdcff;
  border:1px solid #4fdcff;
  border-radius:5px;
}

img{
  max-width:100%;
  max-height:150px;
  margin-top:10px;
  border:1px solid #4fdcff;
  border-radius:5px;
}

.config-status {
  background: rgba(79, 220, 255, 0.1);
  border: 1px solid #4fdcff;
  border-radius: 8px;
  padding: 10px;
  margin: 20px auto;
  max-width: 600px;
  font-size: 12px;
}

.api-status {
  display:inline-block;
  width:10px;
  height:10px;
  border-radius:50%;
  margin-right:5px;
}

.api-status.online { background:#0f0; }
.api-status.offline { background:#f00; }
.api-status.checking { background:#ff0; }
</style>
</head>

<body>

<h2>⚡ IA Orchestrator - Real</h2>

<div id="configStatus" class="config-status">
  <strong>Status das APIs:</strong><br>
  <span id="geminiStatus"><span class="api-status checking"></span>Gemini: Verificando...</span><br>
  <span id="gpt4Status"><span class="api-status checking"></span>GPT-4: Verificando...</span><br>
  <span id="deepseekStatus"><span class="api-status checking"></span>Deepseek: Verificando...</span>
</div>

<div class="container">
  <!-- CAIXA 1 -->
  <div class="box">
    <h3>Caixa 1</h3>
    
    <div class="img-container">
      <label>URL da Imagem:</label>
      <input type="text" id="imgUrl1" placeholder="https://exemplo.com/imagem.jpg">
      <div id="imagePreview1"></div>
    </div>

    <textarea id="input1" placeholder="Digite ou cole conteúdo aqui...">Olá! Como posso te ajudar hoje?</textarea>

    <div id="output1" class="output"></div>
    
    <div id="status1" class="status"></div>

    <div class="buttons">
      <button onclick="sendToIA(1,'gemini')">Enviar → Gemini</button>
      <button onclick="sendToIA(1,'gpt4')">Enviar → GPT-4</button>
      <button onclick="sendToIA(1,'deepseek')">Enviar → Deepseek</button>
      <button onclick="copyBox(1)">Copiar</button>
      <button onclick="pasteBox(1)">Colar</button>
      <button onclick="clearBox(1)">Limpar</button>
    </div>
  </div>

  <!-- CAIXA 2 -->
  <div class="box">
    <h3>Caixa 2</h3>
    
    <div class="img-container">
      <label>URL da Imagem:</label>
      <input type="text" id="imgUrl2" placeholder="https://exemplo.com/imagem.jpg">
      <div id="imagePreview2"></div>
    </div>

    <textarea id="input2" placeholder="Digite ou cole conteúdo aqui...">Explique o que é inteligência artificial.</textarea>

    <div id="output2" class="output"></div>
    
    <div id="status2" class="status"></div>

    <div class="buttons">
      <button onclick="sendToIA(2,'gemini')">Enviar → Gemini</button>
      <button onclick="sendToIA(2,'gpt4')">Enviar → GPT-4</button>
      <button onclick="sendToIA(2,'deepseek')">Enviar → Deepseek</button>
      <button onclick="copyBox(2)">Copiar</button>
      <button onclick="pasteBox(2)">Colar</button>
      <button onclick="clearBox(2)">Limpar</button>
    </div>
  </div>
</div>

<script>
// ===== CONFIGURAÇÃO DAS CHAVES =====
// Apenas as chaves - sem modelos específicos
const KEYS = {
  gemini: window.GEMINI_KEY || "gen-lang-client-0358638661",
  gpt4: window.GPT4_KEY || "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",
  deepseek: window.DEEPSEEK_KEY || "sk-2bf58985cf5c45f9977760d8127627e6"
};

// ===== FUNÇÕES AUXILIARES =====
function showStatus(box, message, type) {
  const status = document.getElementById(`status${box}`);
  status.textContent = message;
  status.className = `status ${type}`;
  setTimeout(() => {
    status.textContent = '';
    status.className = 'status';
  }, 5000);
}

function updateApiStatus(api, status, message) {
  const element = document.getElementById(`${api}Status`);
  const statusDot = element.querySelector('.api-status');
  
  statusDot.className = `api-status ${status}`;
  element.innerHTML = `${statusDot.outerHTML} ${api.toUpperCase()}: ${message}`;
}

// ===== FUNÇÃO PRINCIPAL PARA ENVIAR ÀS IAs =====
async function sendToIA(box, ia) {
  const input = document.getElementById(`input${box}`).value;
  const output = document.getElementById(`output${box}`);
  const imgUrl = document.getElementById(`imgUrl${box}`).value;
  
  if (!input.trim()) {
    showStatus(box, "Digite algo para enviar!", "error");
    return;
  }
  
  showStatus(box, `Enviando para ${ia.toUpperCase()}...`, "loading");
  output.textContent = "Processando... ⏳";
  
  try {
    let response;
    
    switch(ia) {
      case 'gemini':
        response = await sendToGemini(input, imgUrl);
        break;
      case 'gpt4':
        response = await sendToGPT4(input, imgUrl);
        break;
      case 'deepseek':
        response = await sendToDeepseek(input, imgUrl);
        break;
      default:
        throw new Error("IA não suportada");
    }
    
    output.textContent = response;
    showStatus(box, `✅ Resposta recebida!`, "success");
    
  } catch (error) {
    console.error(`Erro ${ia}:`, error);
    output.textContent = `❌ Erro ${ia.toUpperCase()}:\n${error.message}`;
    showStatus(box, `Erro ${ia}`, "error");
  }
}

// ===== CONEXÃO COM GEMINI =====
async function sendToGemini(text, imageUrl) {
  const key = KEYS.gemini;
  
  // URL do Gemini (usando modelo padrão)
  const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${key}`;
  
  let prompt = text;
  if (imageUrl && imageUrl.trim()) {
    prompt = `[IMAGEM: ${imageUrl}]\n\n${text}`;
  }
  
  const response = await fetch(url, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      contents: [{
        parts: [{ text: prompt }]
      }]
    })
  });
  
  if (!response.ok) {
    const error = await response.text();
    throw new Error(`Gemini: ${response.status} - ${error.slice(0, 100)}`);
  }
  
  const data = await response.json();
  return data.candidates?.[0]?.content?.parts?.[0]?.text || "Sem resposta";
}

// ===== CONEXÃO COM GPT-4 =====
async function sendToGPT4(text, imageUrl) {
  const key = KEYS.gpt4;
  
  let content = text;
  if (imageUrl && imageUrl.trim()) {
    content = `Imagem: ${imageUrl}\n\n${text}`;
  }
  
  const response = await fetch('https://api.openai.com/v1/chat/completions', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${key}`
    },
    body: JSON.stringify({
      model: "gpt-4", // Modelo padrão
      messages: [{ role: "user", content: content }],
      temperature: 0.7
    })
  });
  
  if (!response.ok) {
    const error = await response.json();
    throw new Error(`GPT-4: ${error.error?.message || 'Erro'}`);
  }
  
  const data = await response.json();
  return data.choices[0].message.content;
}

// ===== CONEXÃO COM DEEPSEEK =====
async function sendToDeepseek(text, imageUrl) {
  const key = KEYS.deepseek;
  
  let content = text;
  if (imageUrl && imageUrl.trim()) {
    content = `Imagem: ${imageUrl}\n\n${text}`;
  }
  
  const response = await fetch('https://api.deepseek.com/chat/completions', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${key}`
    },
    body: JSON.stringify({
      model: "deepseek-chat", // Modelo padrão
      messages: [{ role: "user", content: content }],
      temperature: 0.7,
      stream: false
    })
  });
  
  if (!response.ok) {
    const error = await response.json();
    throw new Error(`Deepseek: ${error.error?.message || 'Erro'}`);
  }
  
  const data = await response.json();
  return data.choices[0].message.content;
}

// ===== TESTAR CONEXÕES DAS APIS =====
async function testApiConnections() {
  // Testar Gemini
  try {
    updateApiStatus('gemini', 'checking', 'Testando...');
    if (KEYS.gemini && KEYS.gemini.length > 10) {
      updateApiStatus('gemini', 'online', 'Conectado');
    } else {
      updateApiStatus('gemini', 'offline', 'Chave inválida');
    }
  } catch {
    updateApiStatus('gemini', 'offline', 'Erro conexão');
  }
  
  // Testar GPT-4
  try {
    updateApiStatus('gpt4', 'checking', 'Testando...');
    if (KEYS.gpt4 && KEYS.gpt4.length > 10) {
      updateApiStatus('gpt4', 'online', 'Conectado');
    } else {
      updateApiStatus('gpt4', 'offline', 'Chave inválida');
    }
  } catch {
    updateApiStatus('gpt4', 'offline', 'Erro conexão');
  }
  
  // Testar Deepseek
  try {
    updateApiStatus('deepseek', 'checking', 'Testando...');
    if (KEYS.deepseek && KEYS.deepseek.length > 10) {
      updateApiStatus('deepseek', 'online', 'Conectado');
    } else {
      updateApiStatus('deepseek', 'offline', 'Chave inválida');
    }
  } catch {
    updateApiStatus('deepseek', 'offline', 'Erro conexão');
  }
}

// ===== FUNÇÕES DE INTERAÇÃO =====
let buffer = "";

function copyBox(box){
  const output = document.getElementById(`output${box}`).textContent;
  const input = document.getElementById(`input${box}`).value;
  
  buffer = output.trim() || input;
  
  if (buffer) {
    navigator.clipboard.writeText(buffer).then(() => {
      showStatus(box, "Copiado!", "success");
    });
  } else {
    showStatus(box, "Nada para copiar!", "error");
  }
}

function pasteBox(box){
  if (buffer) {
    document.getElementById(`input${box}`).value = buffer;
    showStatus(box, "Colado!", "success");
  } else {
    showStatus(box, "Nada para colar!", "error");
  }
}

function clearBox(box){
  document.getElementById(`input${box}`).value = "";
  document.getElementById(`output${box}`).textContent = "";
  document.getElementById(`imgUrl${box}`).value = "";
  document.getElementById(`imagePreview${box}`).innerHTML = "";
  showStatus(box, "Limpo!", "success");
}

// ===== LOAD IMAGE PREVIEW =====
function loadImage(box) {
  const imgUrl = document.getElementById(`imgUrl${box}`).value;
  const preview = document.getElementById(`imagePreview${box}`);
  
  if (!imgUrl.trim()) {
    preview.innerHTML = "";
    return;
  }
  
  preview.innerHTML = `<img src="${imgUrl}" alt="Preview" onerror="this.style.display='none'">`;
}

// Adicionar evento de input para as URLs de imagem
document.getElementById('imgUrl1').addEventListener('input', () => loadImage(1));
document.getElementById('imgUrl2').addEventListener('input', () => loadImage(2));

// ===== INICIALIZAÇÃO =====
document.addEventListener('DOMContentLoaded', function() {
  // Testar conexões das APIs
  testApiConnections();
  
  // Mensagem inicial
  document.getElementById('output1').textContent = "Pronto! Use os botões para enviar às IAs.";
  document.getElementById('output2').textContent = "Pronto! Use os botões para enviar às IAs.";
  
  console.log("IA Orchestrator iniciado com chaves:");
  console.log("- Gemini:", KEYS.gemini ? "✅" : "❌");
  console.log("- GPT-4:", KEYS.gpt4 ? "✅" : "❌");
  console.log("- Deepseek:", KEYS.deepseek ? "✅" : "❌");
});
</script>

</body>
</html>
